/* ================================
   custom.scss (Dark-only / Quarto)
   --------------------------------
   - Dark theme only (Bootstrap 5.3/Quarto)
   - Language-specific fonts via :lang()
   - Monospace: Monaspace Neon Var
   - Inline code styling (dark)
   ================================ */

/* ----- Dark mode base (support both attributes used by Quarto/Bootstrap) ----- */
html[data-bs-theme="dark"], body[data-mode="dark"] {
  /* Body colors for dark UI */
  --bs-body-bg: #121212;
  --bs-body-color: #e6e6e6;

  /* Optional link & code colors tuned for dark */
  --bs-link-color: #91c9ff;
  --bs-code-color: #ffd8a8;
}

/* ----- Font stacks ----- */
/* Define language-specific sans-serif stacks and the global monospace stack */
:root {
  /* English sans stack (edit to your taste) */
  --font-en-sans: "Inter", system-ui, -apple-system, "Segoe UI", Roboto,
                  "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji",
                  "Segoe UI Emoji", sans-serif;

  /* Japanese sans stack (common JP fonts + fallbacks) */
  --font-ja-sans: "Noto Sans JP", "Hiragino Sans",
                  "Hiragino Kaku Gothic ProN", "Yu Gothic UI", "Yu Gothic",
                  "Meiryo", "Noto Sans CJK JP", sans-serif;

  /* Monospace: Monaspace Neon Var first */
  --bs-font-monospace: "Monaspace Neon Var", ui-monospace, SFMono-Regular, Menlo,
                       Monaco, "Cascadia Code", "Segoe UI Mono", "Roboto Mono",
                       "Ubuntu Mono", "DejaVu Sans Mono", "Liberation Mono", monospace;
}

/* ----- Language-driven font application ----- */
/* Page-level language (HTML lang). Sets body font variables cleanly. */
html:lang(ja) {
  --bs-font-sans-serif: var(--font-ja-sans);
  --bs-body-font-family: var(--bs-font-sans-serif);
}
html:lang(en) {
  --bs-font-sans-serif: var(--font-en-sans);
  --bs-body-font-family: var(--bs-font-sans-serif);
}

/* Inline language spans/blocks (mixed-language documents) */
:lang(ja) { font-family: var(--font-ja-sans); }
:lang(en) { font-family: var(--font-en-sans); }

/* Ensure code-related elements use the specified monospace stack */
code, kbd, samp, pre {
  font-family: var(--bs-font-monospace);
}

/* ================= Inline code (dark) ================= */
/* Scope to inline code only (not code blocks) */
html[data-bs-theme="dark"] :not(pre) > code,
body[data-mode="dark"] :not(pre) > code {
  /* spacing & shape */
  padding: 0.12em 0.38em;
  border-radius: 0.33rem;
  white-space: normal; /* avoid layout shift on wrap */

  /* colors (derived from dark body + code color) */
  color: var(--bs-code-color);
  background-color: color-mix(
    in srgb,
    var(--bs-body-bg, #121212) 86%,
    var(--bs-code-color) 14%
  );

  /* subtle inner border for delineation on dark */
  box-shadow: inset 0 0 0 1px color-mix(in srgb, var(--bs-code-color), transparent 85%);
}

/* High-contrast users: gently increase separation */
@media (prefers-contrast: more) {
  html[data-bs-theme="dark"] :not(pre) > code,
  body[data-mode="dark"] :not(pre) > code {
    background-color: color-mix(
      in srgb,
      var(--bs-body-bg, #121212) 82%,
      var(--bs-code-color) 18%
    );
    box-shadow: inset 0 0 0 1px color-mix(in srgb, currentColor, transparent 75%);
  }
}

/* Safety: do not affect fenced code blocks */
pre > code {
  background: inherit;
  color: inherit;
  box-shadow: none;
  padding: 0;
  border-radius: 0;
}